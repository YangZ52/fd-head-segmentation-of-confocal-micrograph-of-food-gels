# fd-head-segmentation-of-confocal-micrograph-of-food-gels
This repository provides the implementation of a multi-task deep learning framework for micrograph segmentation with explicit global structural supervision, developed to improve the physical realism and quantitative interpretability of segmented protein network microstructures. The model integrates pixel-wise binary segmentation with an auxiliary fractal dimension (FD) prediction head, enabling simultaneous learning of local boundary delineation and global scale-dependent structural characteristics.

The framework is built upon a U-Net–style encoder–decoder architecture with attention-enhanced backbones. It supports joint optimization of segmentation loss (BCE + Dice) and FD regression loss (Huber or MSE) through a tunable weighting parameter (λ). By incorporating FD as a global structural regularizer, the model encourages segmentation outputs that are not only accurate at the pixel level but also consistent with physically meaningful descriptors of network connectivity and heterogeneity.

The code supports systematic λ-sweep experiments, one-shot and staged training strategies, and comprehensive evaluation pipelines, including segmentation metrics (IoU, Dice), FD fidelity analyses (identity and regression, and agreement assessment via Bland–Altman analysis. Training and evaluation are designed to be reproducible and scalable across GPU platforms, with clear separation of data handling, model definition, loss construction, and analysis modules.

This framework is particularly suited for heterogeneous soft-material micrographs, such as protein gels, emulsions, and colloidal networks, where local morphology and global topology jointly govern material properties. While demonstrated here for fractal dimension supervision, the modular design readily accommodates other global or topological descriptors (e.g., lacunarity, connectivity indices, or topology-aware losses), providing a generalizable foundation for physics-informed and structure-aware image segmentation in food, biological, and soft-matter systems.
